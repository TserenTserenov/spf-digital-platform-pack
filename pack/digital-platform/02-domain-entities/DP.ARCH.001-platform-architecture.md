---
id: DP.ARCH.001
type: domain-entity
status: active
created: 2026-02-07
updated: 2026-02-10
trust:
  F: 4
  G: domain
  R: 0.8
epistemic_stage: evidence
---

# Архитектура ИТ-платформы

## 1. Назначение

Документ описывает **архитектуру ИТ-платформы** как прозрачный ящик: слоистую структуру, архитектурные характеристики, универсальный паттерн описания компонентов и принципы проектирования.

## 2. Четыре слоя платформы

```
┌─────────────────────────────────────────────────────────────┐
│  СЛОЙ 4: ИНТЕРФЕЙСЫ (тонкие клиенты)                        │
│  Telegram Bot │ Web LMS │ ChatGPT Apps │ Mobile │ API       │
└───────────────────────────┬─────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  СЛОЙ 3: ИИ-СИСТЕМЫ (stateless, LLM-зависимые)              │
│  Стратег │ Проводник │ Консультант │ Знание-Экстрактор │ …  │
│  (ИИ-агенты и ИИ-ассистенты — виды ИИ-систем, DP.D.009)    │
└───────────────────────────┬─────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  СЛОЙ 2: ДЕТЕРМИНИРОВАННЫЕ СИСТЕМЫ                            │
│  Twin │ Hub │ CRM │ LMS │ Биллинг │ ORY │ Event Bus │ MCP  │
│  guides-mcp │ digital-twin-mcp │ fsm-mcp │ user-repos │ …  │
└───────────────────────────┬─────────────────────────────────┘
                            ▼
┌─────────────────────────────────────────────────────────────┐
│  СЛОЙ 1: ХРАНИЛИЩЕ + ИНФРАСТРУКТУРА                          │
│  GitHub Repos │ PostgreSQL │ SurrealDB │ Embeddings │ Cache  │
└─────────────────────────────────────────────────────────────┘
```

## 3. Описание слоёв

| Слой | Назначение | Характер | Компоненты |
|------|------------|----------|------------|
| **4. Интерфейсы** | Точки входа для пользователей | Тонкие клиенты, без бизнес-логики | Telegram Bot, Web LMS, ChatGPT Apps, Mobile, API |
| **3. ИИ-системы** | Логика, принятие решений, генерация | Stateless, LLM-зависимые | Стратег, Проводник, Консультант, Знание-Экстрактор и др. |
| **2. Детерминированные системы** | Доступ к данным и функциям через стандартный протокол | Детерминированные (ai_role: none/feature) | Twin, Hub, CRM, LMS, ORY, Биллинг, Event Bus, MCP-серверы |
| **1. Хранилище** | Персистентность данных | Физическое хранение | GitHub, PostgreSQL, SurrealDB, индексы (embeddings) |

**Правило взаимодействия:** Каждый слой взаимодействует только с соседним. Интерфейс не обращается к хранилищу. ИИ-система не знает, какой UI у пользователя.

**Исключение:** Прямые операции (`.` заметка) могут идти из интерфейса напрямую в MCP (слой 2), минуя ИИ-систему, если не требуется LLM-обработка.

## 4. Архитектурные характеристики

> Характеристика ≠ Принцип (DP.D.010). Характеристика — измеряемое качество. Принцип — правило для достижения характеристики.

### 4.1. Эволюционируемость (active)

**Определение:** Способность платформы принимать новые сервисы, базы данных и MCP-серверы без изменения существующей структуры.

**Как архитектура обеспечивает:**
- MCP-протокол стандартизирует интерфейс доступа к данным → новый источник = новый MCP, без изменения ИИ-систем
- MCP Registry (yaml) — реестр доступных сервисов → добавление = строка в конфиге
- Event Bus — слабая связанность через события → новый потребитель не меняет продюсера
- ИИ-система = репо с config.yaml → новая система = новый репо, подключение = строка в реестре

**Индикатор:** Количество шагов для добавления нового MCP-сервера. Целевое: ≤3 (создать MCP, зарегистрировать, указать в config.yaml ИИ-системы).

### 4.2. Масштабируемость (active)

**Определение:** Способность платформы обслуживать растущее число пользователей без изменения архитектуры.

**Как архитектура обеспечивает:**
- ИИ-системы (слой 3) — stateless → горизонтальное масштабирование
- Интерфейсы (слой 4) — тонкие клиенты → не хранят состояние
- User-space изолирован → данные одного пользователя не влияют на другого
- MCP per-user → персональные данные разграничены на уровне протокола

**Индикатор:** Требует ли подключение нового пользователя изменений в архитектуре. Целевое: нет.

### 4.3. Обучаемость (active)

**Определение:** Способность платформы улучшать свои решения на основе накопленных данных и обратной связи.

**Как архитектура обеспечивает:**
- Capture-to-Pack фиксирует знания из каждой сессии → Pack обогащается → ИИ-системы получают лучший контекст
- Знание-Экстрактор повышает точность классификации на основе ревью (feedback loop)
- MCP-протокол позволяет подключать аналитику без изменения ИИ-систем
- Memory хранит операционный контекст → каждая следующая сессия эффективнее предыдущей

**Примеры проявлений (по фазам):**
- **Сейчас:** Capture-to-pack обогащает Pack → лучшие инструкции → лучшие результаты
- **Ближайшее:** ИИ-системы адаптируют промпты на основе данных о результативности
- **Будущее:** Рекомендательная система улучшает маршруты на основе паттернов успешных пользователей

**Индикатор:** Улучшается ли качество решений платформы со временем без ручного вмешательства? Целевое: да.

## 5. Универсальный паттерн: Вход-Обработка-Выход (IPO)

Каждый компонент платформы (ИИ-система, сервис, MCP) описывается единым паттерном:

```
┌──────────┐     ┌──────────────┐     ┌──────────┐
│  ВХОДЫ   │ ──▶ │  ОБРАБОТКА   │ ──▶ │  ВЫХОДЫ  │
│ (Inputs) │     │ (Processing) │     │ (Outputs)│
└──────────┘     └──────────────┘     └──────────┘
```

| Элемент | Что описывает | Пример (Стратег) |
|---------|--------------|-----------------|
| **Входы** | Данные, триггеры, внешние источники | Коммиты из git, планы из my-strategy, cron 7:00 |
| **Обработка** | Логика, алгоритмы, LLM-промпты | Агрегация РП, генерация плана дня |
| **Выходы** | Артефакты, команды, события | DayPlan.md, WeekPlan.md, PLAN.DayCreated |

**Правило:** Любой паспорт ИИ-системы, описание сервиса или MCP-сервера ДОЛЖЕН содержать IPO-секции.

## 6. Принцип отчуждаемости

> Platform-space ≠ User-space (DP.D.011)

**Определение:** Каждый компонент платформы строится для передачи другим людям.

| Аспект | Platform-space | User-space |
|--------|---------------|------------|
| **Что** | Модули, шаблоны, правила, ИИ-системы | РП, репо, captures, предпочтения |
| **Кто обновляет** | Разработчики платформы | Пользователь + его ИИ-системы |
| **Переносимость** | Одинаково для всех | Уникально для каждого |

**Правило:** Если компонент содержит hardcoded данные конкретного пользователя — это нарушение отчуждаемости. Персонализация — через конфигурацию (user-space), не через код (platform-space).

## 7. Архитектурные принципы

| # | Принцип | Описание | Обеспечивает характеристику |
|---|---------|----------|----------------------------|
| 1 | **Модульность** | Каждый компонент — чётко определённый круг задач | Эволюционируемость |
| 2 | **Слабая связанность** | Взаимодействие через API, MCP и события | Эволюционируемость |
| 3 | **Event-driven** | Loose coupling через Event Bus | Эволюционируемость, Масштабируемость |
| 4 | **IPO-единообразие** | Все компоненты описываются через Вход-Обработка-Выход | Эволюционируемость |
| 5 | **Evolvability-first** | При выборе между простотой сейчас и расширяемостью потом — выбираем расширяемость | Эволюционируемость |
| 6 | **Отчуждаемость** | Всё строится для передачи: platform-space vs user-space | Масштабируемость |
| 7 | **Реестр, не hardcode** | Все MCP, ИИ-системы описаны в реестрах (yaml) | Эволюционируемость |
| 8 | **Персональные данные изолированы** | Доступ к user-space только по делегации | Масштабируемость |

## 8. Ключевые механизмы

### 8.1. Цифровой двойник

**Назначение:** Единое хранилище состояния человека (слой 2, MCP).

| Тип | Префикс | Описание |
|-----|---------|----------|
| События | E.* | Все действия (обучение, задания, активность) |
| Слоты | SLT.* | Время, выделенное на развитие |
| Рабочие продукты | W.* | Артефакты (конспекты, модели) |
| Маршруты | ROUTE.* | Планы и шаги развития |
| Ступени | STAGE.* | Текущий уровень |
| Метрики | MET.* | Агрегированные показатели |

### 8.2. Экзокортекс-интерфейс пользователя

**Назначение:** Точка подключения пользователя к платформе (см. [DP.EXOCORTEX.001](DP.EXOCORTEX.001-modular-exocortex.md)).

Модульный CLAUDE.md + Memory — конфигурация взаимодействия пользователя с ИИ-системами. Platform-space (общие модули) + user-space (персональный контекст).

### 8.3. Токены за активность

```
LMS/Клуб → Activity Hub → Proof-of-Impact → Token Economy
(события)   (сбор)        (ML-оценка)       (начисление)
```

### 8.4. MCP Registry

Три категории MCP-серверов:

| Категория | Характер | Примеры | Доступ |
|-----------|----------|---------|--------|
| **Базы знаний** | Read-only | guides-mcp, pack-MCP | Все пользователи |
| **Персональные данные** | Read/Write per user | digital-twin-mcp, user-repos | Только владелец + делегированные |
| **Сервисы** | Read/Write | fsm-mcp, linear, github | По авторизации |

## 9. Связанные документы

- [DP.CONCEPT.001 Концепция платформы](DP.CONCEPT.001-platform-concept.md)
- [DP.AGENT.001 ИИ-системы платформы](DP.AGENT.001-ai-agents.md)
- [DP.SYS.001 Детерминированные системы](DP.SYS.001-deterministic-systems.md)
- [DP.EXOCORTEX.001 Модульный экзокортекс](DP.EXOCORTEX.001-modular-exocortex.md)
- [DP.NAV.001 Навигация знаний](DP.NAV.001-knowledge-navigation.md)
- [DP.AISYS.013 Знание-Экстрактор](DP.AISYS.013-knowledge-extractor.md)
