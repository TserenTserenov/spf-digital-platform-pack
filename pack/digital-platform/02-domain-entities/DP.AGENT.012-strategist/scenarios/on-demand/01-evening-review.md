---
id: AGT.012.SC.05
type: scenario
trigger: on-demand
status: draft
created: 2026-02-07
---

# Evening Review

## Назначение

Подведение итогов дня по запросу пользователя. Вызывается в конце рабочего дня.

## Триггер

- **Тип:** По запросу
- **Команда:** `/evening`
- **Когда:** Конец рабочего дня

## Входы

| Источник | Данные | Обязательность |
|----------|--------|----------------|
| `current/daily/YYYY-MM-DD.md` | План на сегодня | Если есть |
| Git log | Коммиты за сегодня | Обязательно |
| `current/weekly-plan.md` | План недели | Для контекста |

## Алгоритм

### Шаг 1: Сбор данных

1. Загрузить план дня (если есть)
2. **КРИТИЧЕСКИ ВАЖНО:** Получить коммиты за сегодня из **ВСЕХ** репозиториев в `~/Github/`
3. Сгруппировать коммиты по репозиториям

**Команда для сбора коммитов из всех репо:**
```bash
for repo in $(ls ~/Github/); do
  if [ -d ~/Github/$repo/.git ]; then
    commits=$(cd ~/Github/$repo && git log --oneline --since="today 00:00" 2>/dev/null | wc -l)
    if [ "$commits" -gt 0 ]; then
      echo "=== $repo ($commits) ==="
      cd ~/Github/$repo && git log --oneline --since="today 00:00"
    fi
  fi
done
```

**ЗАПРЕЩЕНО:** Проверять только репозитории из текущей сессии. Пользователь работает в нескольких сессиях параллельно.

### Шаг 2: Сопоставление

1. Сопоставить запланированные РП с фактом
2. Отметить статусы: done, partial, not started
3. Выявить незапланированную работу

### Шаг 3: Расчёт статистики

```
Статистика дня:
- Запланировано: X РП
- Завершено: Y РП
- Коммитов: Z
- Время (оценка по коммитам): Wh
```

### Шаг 4: Обновление плана

1. Обновить статусы РП в дневном плане
2. Отметить carry-over на завтра

## Выходы

| Артефакт | Путь | Описание |
|----------|------|----------|
| Обновлённый план дня | `current/daily/YYYY-MM-DD.md` | Со статусами |
| Коммит | — | Фиксация итогов |

## Формат вывода

```markdown
## Итоги дня: [дата]

### Что сделано

| # | РП | План | Факт | Коммитов |
|---|-----|------|------|----------|
| 1 | РП-1 | 2h | done | 3 |
| 2 | РП-2 | 1h | partial | 1 |
| 3 | РП-3 | 1.5h | not started | 0 |

### Незапланированное

- Работа X (2 коммита)

### Статистика

| Метрика | Значение |
|---------|----------|
| Запланировано | X РП |
| Завершено | Y РП |
| Completion | Z% |
| Коммитов | N |

### Carry-over на завтра

- РП-2 (partial)
- РП-3 (not started)

---

Хорошего вечера!
```

## Метрики успеха

| Метрика | Целевое |
|---------|---------|
| Ревью завершено | Да |
| План обновлён | Да |
| Carry-over отмечен | Да |

## Ошибки и fallback

| Ошибка | Действие |
|--------|----------|
| Нет плана дня | Работать только с коммитами |
| Нет коммитов | Отметить "день без активности" |

## Связанные сценарии

- **Перед:** [02-day-plan](../scheduled/02-day-plan.md)
- **Данные используются:** [03-week-review](../scheduled/03-week-review.md)
